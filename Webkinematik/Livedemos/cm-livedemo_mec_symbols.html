<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <link href="https://gitcdn.xyz/repo/goessner/CodeMirror/master/theme/fh-do.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/codemirror/4.5.0/codemirror.css" rel="stylesheet" />
</head>

<body>
  <canvas id="canvas" width="680" height="150" class="playable-canvas"></canvas>
  <div class="playable-buttons">
    <input id="edit" type="button" value="Edit" />
    <input id="reset" type="button" value="Reset" />
  </div>
  <textarea id="code" class="playable-code">
g.cartesian()
 .use("origin",{x:20,y:80})     .label("origin","s",25)
 .use("nod",{x:100,y:80})       .label("nod","s",25)
 .use("dblnod",{x:180,y:80})    .label("dblnod","s",25)
 .use("nodfix",{x:260,y:80})    .label("nodfix","s",25)
 .use("dblnodfix",{x:340,y:80}) .label("dblnodfix","s",25)
 .use("nodflt",{x:420,y:80})    .label("nodflt","s",25)
 .use("dblnodflt",{x:500,y:80}) .label("dblnodflt","s",25)
 .use("pol",{x:580,y:80})       .label("pol","s",25)
 .use("gnd",{x:660,y:80})       .label("gnd","s",25)
 .exe(ctx)</textarea>

  <script src="https://gitcdn.xyz/repo/goessner/g2/master/g2.min.js"></script>
  <script src="https://gitcdn.xyz/repo/goessner/g2-mec/master/g2.mec.min.js"></script>
  <script src="https://cdn.jsdelivr.net/codemirror/4.5.0/codemirror.min.js"></script>
  <script src="https://cdn.jsdelivr.net/codemirror/4.5.0/mode/javascript/javascript.js"></script>
  <script>

var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");
var reset = document.getElementById("reset");
var edit = document.getElementById("edit");
var g = g2();
var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
  mode:  "javascript",
  lineNumbers: true,
  theme: "fh-do",
  styleActiveLine: true,
  matchBrackets: true,
});
var code = editor.getValue();

function drawCanvas() {
  g.del().clr();
  eval(editor.getValue());
}

reset.addEventListener("click", function() {
  editor.setValue(code);
  drawCanvas();
});

edit.addEventListener("click", function() {
  editor.focus();
})

window.addEventListener("load", drawCanvas);

editor.on('change', function (editor) {
  drawCanvas();
});

</script>
</body>

</html>