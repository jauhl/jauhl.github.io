<!doctype html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Rad</title>
</head>

<body>
    <h2>Rad</h2>
    <canvas id="c" width="900" height="150" style="border-width:1px;border-style:solid"></canvas>

    <script src="https://gitcdn.xyz/repo/goessner/g2/master/src/g2.js"></script>
    

    <script>

let cnv = document.getElementById('c'),
    ctx = cnv.getContext('2d'),

    pi = Math.PI

    a = 0.5,    // Beschleunigung [m/s^2]
    v0 = 0,     // Anfangsgeschwindigkeit [m/s]
    s0 = 0.05,  // Anfangsstrecke [m]
    s = 0,      // Strecke [mm]

    t0 = false,     // Animationsstartzeit

    mec = {
        R: 50, // Radius Rad [mm]
        get A()    { return {x:s, y:70, w:-s/this.R}; }  // Mittelpunkt Rad, w aus Haftbedingung bei Ueberlagerung der Geschwindigkeiten
    },

    maxs = cnv.width + mec.R,

    wheel = g2(),
    world = g2().clr().view({cartesian:true})
                .use({grp:wheel})
                .ground({pts:[0,20, cnv.width,20], closed:false, h:10})
    ;

function position(t) {
    s = (0.5*a*t*t + v0*t + s0)*1000; // s(t) in [mm]

    wheel.del()
         .pulley2({...mec.A, r:mec.R})
         .nod(mec.A)
}

function render(time) {
    /** Starte Animation (neu) durch Zuweisung t0 = time wenn t0 = false ist,
     *  oder wenn die Strecke x groeÃŸer ist als die Canvasbreite + Radius des Rads
     *  (Rad ist nicht mehr zu sehen weil es aus der Zeichenflaeche herausgerollt ist)
     * */
    if (!t0 || s > maxs)
        t0 = time;

    position((time-t0)/1000);
    world.exe(ctx);
    requestAnimationFrame(render);
}

render();

    </script>
</body>
</html>
