<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <style>
    body {
      padding: 0;
      margin: 0;
    }
    .CodeMirror {
      border: 1px solid #eee;
      height: auto !important;
      width: 90%;
    }
    .CodeMirror-cursor { 
      border-left: 1px solid #f8f8f0 !important; 
    }
    svg:not(:root) {
      display: block;
    }
/*
    .playable-code {
      background-color: #F4F7F8;
      border: none;
      border-left: 6px solid #ff6900;
      border-width: medium medium medium 6px;
      color: #4D4E53;
      height: 110px;
      width: 90%;
      padding: 10px 10px 0px;
    }
*/    
    .playable-canvas {
      border: 1px solid #4D4E53;
      border-radius: 2px;
    }
    .playable-buttons {
      text-align: right;
      width: 90%;
      padding: 5px 10px 5px 2px;
    }
  </style>
  <link href="https://cdn.jsdelivr.net/codemirror/4.5.0/codemirror.css" rel="stylesheet" />
  <link href="https://codemirror.net/theme/monokai.css" rel="stylesheet" />
  
</head>

<body>
  <canvas id="canvas" width="200" height="120" class="playable-canvas"></canvas>
  <div class="playable-buttons">
    <input id="edit" type="button" value="Edit" />
    <input id="reset" type="button" value="Reset" />
  </div>

  <script src="https://gitcdn.xyz/repo/goessner/g2/master/g2.min.js"></script>
  <script src="https://gitcdn.xyz/repo/goessner/g2-mec/master/g2.mec.min.js"></script>
  <script src="https://cdn.jsdelivr.net/codemirror/4.5.0/codemirror.min.js"></script>
  <script src="https://cdn.jsdelivr.net/codemirror/4.5.0/mode/javascript/javascript.js"></script>
  <script type="text/javascript">

var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");
var reset = document.getElementById("reset");
var edit = document.getElementById("edit");
var g = g2();
var editor = CodeMirror(document.body, {
  value: "g.cartesian()\n .link([20,60,40,95,60,70])\n .link([20,20,40,55,60,30],true)\n .link2([120,60,140,95,160,70])\n .link2([120,20,140,55,160,30],true)\n .exe(ctx)",
  mode:  "javascript",
  lineNumbers: true,
  theme: "monokai",
  styleActiveLine: true,
  matchBrackets: true,
  cursorHeight: 1
});
var code = editor.getValue();

function drawCanvas() {
  g.del().clr();
  eval(editor.getValue());
}

reset.addEventListener("click", function() {
  editor.setValue(code);
  drawCanvas();
});

edit.addEventListener("click", function() {
  editor.focus();
})

window.addEventListener("load", drawCanvas);

editor.on('change', function () {
        drawCanvas();
    });

</script>
</body>

</html>